from .ellipticcurve import CurveFp, PointJacobi

class Curve:
    def __init__(self, name, curve_fp, generator, order):
        self.name = name
        self.curve = curve_fp
        self.generator = PointJacobi(
            self.curve, generator[0], generator[1], 1, order
        )
        self.order = order
        self.baselen = (order.bit_length() + 7) // 8

# SECP256k1 parameters
_secp256k1_p = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F
_secp256k1_a = 0
_secp256k1_b = 7
_secp256k1_gx = 0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798
_secp256k1_gy = 0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8
_secp256k1_order = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141

SECP256k1 = Curve(
    "secp256k1",
    CurveFp(_secp256k1_p, _secp256k1_a, _secp256k1_b),
    (_secp256k1_gx, _secp256k1_gy),
    _secp256k1_order
)

# NIST P-256 (secp256r1)
_p256_p = 0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF
_p256_a = 0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC
_p256_b = 0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B
_p256_gx = 0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296
_p256_gy = 0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5
_p256_order = 0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551

NIST256p = Curve(
    "nist256p",
    CurveFp(_p256_p, _p256_a, _p256_b),
    (_p256_gx, _p256_gy),
    _p256_order
)
